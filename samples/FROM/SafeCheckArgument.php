<?php
/*	Safe SQL, using concatenation and checking the argument (using in_array )
*/

//$tainted contains the data given by the user (and potentially unsafe)

if (isset($_GET['user'])) {
    $tainted = $_GET['user'];
} else {
    $tainted = "unsafe_<>_'";
    $_GET['user'] = $tainted;
}

$legal_table =  array("users", "connexions");
if (in_array($tainted, $legal_table, true)) {
    $clean_table = $table;
} else {
        $clean_table = $legal_table[0];
}
    

$query = "SELECT * FROM $clean_table";

$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)

$res = mysql_query($query); //execution
    
