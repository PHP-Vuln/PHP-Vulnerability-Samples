<?php
/*	Unsafe SQL request using variable interpretation and the function mysql_real_escape_string in the ORDER BY
	vulnerable to argument like : 
	user DESC ; DROP TABLE USERS ; 
	...
*/


//$tainted contains the data given by the user (and potentially unsafe)

if (isset($_GET['user'])) {
    $tainted = $_GET['user'];
} else {
    $tainted = "unsafe_<>_'";
    $_GET['user'] = $tainted;
}

$query = "SELECT * FROM USERS WHERE user = 'toto' ORDER BY " . mysql_real_escape_string($tainted) . " DESC";

$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)

$res = mysql_query($query); //execution
    
